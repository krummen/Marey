<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interaktive Übungen: Das Auge</title>
    <style>
        body {
            font-family: sans-serif;
            line-height: 1.6;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        .container {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1, h2, h3 {
            color: #0056b3;
        }
        .question {
            margin-bottom: 15px;
            padding: 10px;
            border-left: 4px solid #007bff;
            background-color: #e9f5ff;
        }
        .question p {
            margin-top: 0;
        }
        input[type="text"], select, textarea {
            padding: 8px;
            margin: 5px 0 10px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: calc(100% - 18px); /* Adjust for padding and border */
            max-width: 300px;
            box-sizing: border-box;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .feedback {
            margin-top: 5px;
            font-weight: bold;
        }
        .correct {
            color: green;
            /* Make sure the border of the question div also turns green/red */
        }
        .question.correct {
             border-left-color: green;
        }
        .incorrect {
            color: red;
        }
        .question.incorrect {
            border-left-color: red;
        }
        .explanation {
            font-size: 0.9em;
            color: #555;
            margin-top: 5px;
        }
        .diagram-container {
            text-align: center;
            margin-bottom: 20px;
        }
        .diagram-container img {
            max-width: 100%;
            height: auto;
            border: 1px solid #ccc;
        }
        .label-input {
            display: inline-block;
            margin: 5px;
        }
        .label-input input {
            width: 120px;
        }
        ul {
            list-style-type: none;
            padding-left: 0;
        }
        li {
            margin-bottom: 8px;
        }
        .anforderungsbereich {
            font-style: italic;
            color: #666;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>

    <h1>Interaktive Übungen: Das Auge</h1>
    <p>Hallo! Bearbeite die folgenden Aufgaben, um dein Wissen über das Auge zu testen und zu vertiefen.</p>

    <div class="container">
        <h2>Teil 1: Aufbau und grundlegende Funktionen (AFB 1)</h2>
        <p class="anforderungsbereich">Anforderungsbereich 1: Wissen wiedergeben</p>

        <div class="question">
            <p><strong>Aufgabe 1: Lückentext zu den Sehzellen</strong><br>
            Fülle die Lücken im folgenden Text aus. Achte auf die richtige Schreibweise.</p>
            <p>
                In der Netzhaut des Auges befinden sich zwei Sorten von Sehzellen: die Stäbchen und die Zapfen.
                Die Stäbchen reagieren nur auf verschiedene <input type="text" id="q1_1" placeholder="Antwort hier">.
                Sie sind für das <input type="text" id="q1_2" placeholder="Antwort hier">-Sehen zuständig.
                Die Zapfen sind für das <input type="text" id="q1_3" placeholder="Antwort hier"> zuständig. Es gibt drei Sorten von Zapfen, die jeweils für eine der folgenden Farben empfindlich sind: Rot, <input type="text" id="q1_4" placeholder="Antwort hier"> und Blau.
                Alle Informationen werden schließlich über den Sehnerv an das <input type="text" id="q1_5" placeholder="Antwort hier"> weitergeleitet.
            </p>
            <div id="feedback_q1" class="feedback"></div>
        </div>

        <div class="question">
            <p><strong>Aufgabe 2: Teile des Auges benennen</strong><br>
            Betrachte das Schema eines Auges. Benenne die markierten Teile (1-5). Nutze die Begriffe: <i>Linse, Hornhaut, Netzhaut, Sehnerv, Pupille</i>.</p>
            <div class="diagram-container">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Eye_scheme_numbers_de.svg/500px-Eye_scheme_numbers_de.svg.png" alt="Schema des Auges">
                <p><small>Bildquelle: Wikimedia Commons, User: M.Minderhoud, Chabacano, CC BY-SA 3.0</small></p>
                <p><i>Hinweis: Die Nummerierung im Bild dient nur zur Orientierung für die Eingabefelder. Die Zahlen entsprechen nicht unbedingt den Nummern aus deinen Unterlagen.</i></p>
            </div>
            <div class="label-input">1 (äußerste transparente Schicht vorne): <input type="text" id="label1_1"></div><div id="feedback_label1_1" class="feedback"></div>
            <div class="label-input">2 (Öffnung in der Mitte der Iris): <input type="text" id="label1_2"></div><div id="feedback_label1_2" class="feedback"></div>
            <div class="label-input">3 (hinter der Pupille, bricht Licht): <input type="text" id="label1_3"></div><div id="feedback_label1_3" class="feedback"></div>
            <div class="label-input">4 (lichtempfindliche Schicht hinten): <input type="text" id="label1_4"></div><div id="feedback_label1_4" class="feedback"></div>
            <div class="label-input">5 (leitet Signale zum Gehirn): <input type="text" id="label1_5"></div><div id="feedback_label1_5" class="feedback"></div>
            <div id="feedback_label1_overall" class="feedback"></div> <!-- Overall feedback for question 2 -->
        </div>
    </div>

    <div class="container">
        <h2>Teil 2: Funktionen und Vorgänge verstehen (AFB 2)</h2>
        <p class="anforderungsbereich">Anforderungsbereich 2: Wissen anwenden und Zusammenhänge erklären</p>

        <div class="question">
            <p><strong>Aufgabe 3: Funktionen zuordnen</strong><br>
            Welche Hauptfunktion hat die Lederhaut?</p>
            <ul>
                <li><label><input type="radio" name="q3_1" value="a"> Lichtbrechung</label></li>
                <li><label><input type="radio" name="q3_1" value="b"> Schutz und Stabilität des Augapfels</label></li>
                <li><label><input type="radio" name="q3_1" value="c"> Versorgung mit Nährstoffen</label></li>
            </ul>
            <div id="feedback_q3_1" class="feedback"></div>

            <p>Welche Hauptfunktion hat die Aderhaut?</p>
            <ul>
                <li><label><input type="radio" name="q3_2" value="a"> Regulation des Lichteinfalls</label></li>
                <li><label><input type="radio" name="q3_2" value="b"> Reizaufnahme und Signalwandlung</label></li>
                <li><label><input type="radio" name="q3_2" value="c"> Versorgung der Netzhaut mit Nährstoffen und Sauerstoff</label></li>
            </ul>
            <div id="feedback_q3_2" class="feedback"></div>

            <p>Welche Hauptfunktion hat die Regenbogenhaut (Iris)?</p>
            <ul>
                <li><label><input type="radio" name="q3_3" value="a"> Das Bild auf der Netzhaut scharf stellen</label></li>
                <li><label><input type="radio" name="q3_3" value="b"> Die Größe der Pupille regulieren und damit den Lichteinfall steuern</label></li>
                <li><label><input type="radio" name="q3_3" value="c"> Den Augapfel bewegen</label></li>
            </ul>
            <div id="feedback_q3_3" class="feedback"></div>
        </div>

        <div class="question">
            <p><strong>Aufgabe 4: Der Sehvorgang</strong><br>
            Beschreibe in 2-3 Sätzen mit eigenen Worten, wie ein Bild auf der Netzhaut entsteht, wenn du einen Gegenstand betrachtest.</p>
            <textarea id="q4_1" rows="4" placeholder="Deine Erklärung..."></textarea>
            <div id="feedback_q4_1" class="feedback"><i>Diese Frage wird nicht automatisch bewertet. Besprich deine Antwort mit deiner Lehrkraft. Wichtige Stichpunkte: Licht vom Gegenstand, Hornhaut und Linse brechen Licht, umgekehrtes und verkleinertes Bild auf der Netzhaut.</i></div>
        </div>

        <div class="question">
            <p><strong>Aufgabe 5: Akkommodation</strong><br>
            Was versteht man unter Akkommodation des Auges?</p>
            <ul>
                <li><label><input type="radio" name="q5_1" value="a"> Die Anpassung an unterschiedliche Lichthelligkeiten durch die Pupille.</label></li>
                <li><label><input type="radio" name="q5_1" value="b"> Die Fähigkeit des Auges, durch Veränderung der Linsenkrümmung Objekte in unterschiedlicher Entfernung scharf zu sehen.</label></li>
                <li><label><input type="radio" name="q5_1" value="c"> Die Umwandlung von Lichtreizen in Nervenimpulse in der Netzhaut.</label></li>
            </ul>
            <div id="feedback_q5_1" class="feedback"></div>
            <p>Welcher Teil des Auges ist hauptsächlich für die Akkommodation verantwortlich, indem er die Form der Linse verändert?</p>
            <input type="text" id="q5_2" placeholder="Name des Muskels/Teils">
            <div id="feedback_q5_2" class="feedback"></div>
        </div>
    </div>

    <div class="container">
        <h2>Teil 3: Fehlsichtigkeiten und komplexe Zusammenhänge (AFB 3)</h2>
        <p class="anforderungsbereich">Anforderungsbereich 3: Problemlösen, Bewerten und Reflektieren</p>

        <div class="question">
            <p><strong>Aufgabe 6: Kurzsichtigkeit (Myopie)</strong></p>
            <p>Bei der Kurzsichtigkeit sehen Betroffene in der Ferne unscharf. Was ist meist die Ursache dafür?</p>
            <ul>
                <li><label><input type="radio" name="q6_1" value="a"> Der Augapfel ist zu kurz oder die Brechkraft der Linse ist zu schwach.</label></li>
                <li><label><input type="radio" name="q6_1" value="b"> Der Augapfel ist zu lang oder die Brechkraft der Linse ist zu stark.</label></li>
                <li><label><input type="radio" name="q6_1" value="c"> Die Linse hat ihre Elastizität verloren.</label></li>
            </ul>
            <div id="feedback_q6_1" class="feedback"></div>
            <p>Wo entsteht das scharfe Bild bei einem kurzsichtigen Auge, wenn es ein fernes Objekt betrachtet, ohne Korrektur?</p>
            <input type="text" id="q6_2" placeholder="z.B. vor/hinter/auf der Netzhaut">
            <div id="feedback_q6_2" class="feedback"></div>
            <p>Mit welcher Art von Brillenglas wird Kurzsichtigkeit korrigiert?</p>
            <input type="text" id="q6_3" placeholder="z.B. Sammel- oder Zerstreuungslinse">
            <div id="feedback_q6_3" class="feedback"></div>
        </div>

        <div class="question">
            <p><strong>Aufgabe 7: Weitsichtigkeit (Hyperopie)</strong></p>
            <p>Bei der Weitsichtigkeit sehen Betroffene in der Nähe unscharf. Was ist meist die Ursache dafür?</p>
            <ul>
                <li><label><input type="radio" name="q7_1" value="a"> Der Augapfel ist zu kurz oder die Brechkraft der Linse ist zu schwach.</label></li>
                <li><label><input type="radio" name="q7_1" value="b"> Der Augapfel ist zu lang oder die Brechkraft der Linse ist zu stark.</label></li>
                <li><label><input type="radio" name="q7_1" value="c"> Die Hornhaut ist unregelmäßig gekrümmt.</label></li>
            </ul>
            <div id="feedback_q7_1" class="feedback"></div>
            <p>Wo würde das scharfe Bild bei einem weitsichtigen Auge entstehen, wenn es ein nahes Objekt betrachtet, ohne dass das Auge akkommodiert?</p>
            <input type="text" id="q7_2" placeholder="z.B. vor/hinter/auf der Netzhaut">
            <div id="feedback_q7_2" class="feedback"></div>
            <p>Mit welcher Art von Brillenglas wird Weitsichtigkeit korrigiert?</p>
            <input type="text" id="q7_3" placeholder="z.B. Sammel- oder Zerstreuungslinse">
            <div id="feedback_q7_3" class="feedback"></div>
        </div>
        
        <div class="question">
            <p><strong>Aufgabe 8: Alterssichtigkeit (Presbyopie)</strong></p>
            <p>Erkläre kurz, warum viele ältere Menschen eine Lesebrille benötigen, auch wenn sie vorher normalsichtig waren.</p>
            <textarea id="q8_1" rows="3" placeholder="Deine Erklärung..."></textarea>
            <div id="feedback_q8_1" class="feedback"><i>Diese Frage wird nicht automatisch bewertet. Besprich deine Antwort mit deiner Lehrkraft. Stichwort: Elastizitätsverlust der Linse, Akkommodationsfähigkeit nimmt ab.</i></div>
        </div>

        <div class="question">
            <p><strong>Aufgabe 9: Denkaufgabe - Was wäre wenn?</strong><br>
            Stell dir vor, der Ziliarmuskel eines Auges wäre gelähmt und könnte sich nicht mehr zusammenziehen. Welche Folge hätte das für das Sehen dieser Person? Begründe deine Antwort.</p>
            <textarea id="q9_1" rows="4" placeholder="Deine Überlegungen..."></textarea>
            <div id="feedback_q9_1" class="feedback"><i>Diese Frage wird nicht automatisch bewertet. Besprich deine Antwort mit deiner Lehrkraft. Überlege, welche Funktion der Ziliarmuskel hat (Akkommodation, Linsenkrümmung) und was passiert, wenn diese Funktion ausfällt (Scharfsehen in der Nähe?).</i></div>
        </div>
    </div>

    <button onclick="checkAllAnswers()">Alle Antworten prüfen und Auswertung anzeigen</button>
    <div id="overall_feedback" class="container" style="margin-top: 20px; display: none;">
        <h3>Gesamtauswertung</h3>
        <p id="score_display"></p>
        <p>Überprüfe die einzelnen Rückmeldungen bei den Fragen für Details.</p>
    </div>

<script>
    const correctAnswers = {
        q1_1: "lichtmengen",
        q1_2: "hell-dunkel",
        q1_3: "farbensehen",
        q1_4: "grün",
        q1_5: "gehirn",
        label1_1: "hornhaut",
        label1_2: "pupille",
        label1_3: "linse",
        label1_4: "netzhaut",
        label1_5: "sehnerv",
        q3_1: "b",
        q3_2: "c",
        q3_3: "b",
        q5_1: "b",
        q5_2: "ziliarmuskel",
        q6_1: "b",
        q6_2: "vor der netzhaut",
        q6_3: "zerstreuungslinse",
        q7_1: "a",
        q7_2: "hinter der netzhaut",
        q7_3: "sammellinse"
    };

    const explanations = {
        q1_1: "Stäbchen sind sehr lichtempfindlich und für das Sehen bei Dämmerung zuständig.",
        q1_2: "Sie unterscheiden nur Helligkeitsstufen.",
        q1_3: "Zapfen benötigen mehr Licht und ermöglichen das Farbsehen.",
        q1_4: "Die drei Zapfentypen sind für Rot, Grün und Blau empfindlich.",
        q1_5: "Das Gehirn verarbeitet die Signale zu einem Seheindruck.",
        label1_1: "Die Hornhaut ist der vordere, durchsichtige Teil des Auges und bricht das Licht.",
        label1_2: "Die Pupille ist die Öffnung, durch die Licht ins Auge gelangt.",
        label1_3: "Die Linse bricht das Licht und fokussiert es auf die Netzhaut.",
        label1_4: "Die Netzhaut enthält die Lichtsinneszellen (Stäbchen und Zapfen).",
        label1_5: "Der Sehnerv leitet die elektrischen Impulse von der Netzhaut zum Gehirn.",
        q3_1: "Die Lederhaut (Sklera) ist die äußere, feste Hülle des Auges.",
        q3_2: "Die Aderhaut liegt zwischen Lederhaut und Netzhaut und ist stark durchblutet.",
        q3_3: "Die Iris (Regenbogenhaut) ist der farbige Teil des Auges.",
        q5_1: "Dies ermöglicht scharfes Sehen in Ferne und Nähe.",
        q5_2: "Der Ziliarmuskel (auch Ringmuskel genannt) verändert durch Kontraktion und Entspannung die Krümmung der Linse.",
        q6_1: "Dadurch werden ferne Objekte vor der Netzhaut abgebildet.",
        q6_2: "Das Bild ferner Objekte entsteht unscharf auf der Netzhaut, weil der Brennpunkt davor liegt.",
        q6_3: "Eine Zerstreuungslinse (Konkavlinse) 'verlängert' den Brennpunkt, sodass er auf die Netzhaut fällt.",
        q7_1: "Dadurch werden nahe Objekte hinter der Netzhaut abgebildet (ohne starke Akkommodation).",
        q7_2: "Das Bild naher Objekte würde unscharf auf der Netzhaut entstehen, weil der Brennpunkt dahinter liegt (ohne Akkommodation).",
        q7_3: "Eine Sammellinse (Konvexlinse) 'verkürzt' den Brennpunkt, sodass er auf die Netzhaut fällt."
    };

    function normalizeAnswer(answer) {
        if (typeof answer !== 'string') return "";
        return answer.toLowerCase().trim().replace(/\s+/g, ' ').replace(/-/g, '');
    }
    
    // KORRIGIERTE checkAnswer Funktion
    function checkAnswer(id) {
        const questionElement = document.getElementById(id);
        const feedbackElement = document.getElementById('feedback_' + id); // Kann null sein für q1_X
        let parentQuestionDiv = null;

        // Nur versuchen, parentQuestionDiv zu bekommen, wenn feedbackElement existiert.
        // Für q1_X gibt es kein feedback_q1_X, also wird dies übersprungen.
        // Für label1_X und andere gibt es feedback_label1_X, also wird es gefunden.
        if (feedbackElement) {
            parentQuestionDiv = feedbackElement.closest('.question');
            // Falls feedback_label1_1 kein direktes .question Elternelement hat (weil es nicht direkt in .question ist),
            // dann suchen wir das .question der übergeordneten Beschriftungsaufgabe.
            if (!parentQuestionDiv && id.startsWith('label1_')) {
                 parentQuestionDiv = document.getElementById('feedback_label1_overall').closest('.question');
            }
        }


        let userAnswer;
        let isCorrect = false;

        if (!questionElement) {
            // console.warn("Kein Frageelement gefunden für ID:", id);
            return false; // Kann nicht prüfen, wenn das Frageelement selbst fehlt
        }

        if (questionElement.type === 'text' || questionElement.tagName === 'TEXTAREA') {
            userAnswer = normalizeAnswer(questionElement.value);
            let correctAnswerText = normalizeAnswer(correctAnswers[id]);
            
            if (id === 'q1_2' && (userAnswer === "helldunkel" || userAnswer === "schwarzweiß" || userAnswer === "schwarzweiss")) {
                 isCorrect = true;
            } else if (id === 'q5_2' && (userAnswer === "ziliarmuskel" || userAnswer === "ringmuskel")) {
                 isCorrect = true;
            } else if ((id === 'q6_2' || id === 'q7_2') && userAnswer.includes(correctAnswerText) && userAnswer.length > 5) { // Mindestlänge um "vor" nicht als richtig zu werten
                 isCorrect = true;
            } else if (id === 'q6_3' && (userAnswer === "zerstreuungslinse" || userAnswer === "konkavlinse")) {
                 isCorrect = true;
            } else if (id === 'q7_3' && (userAnswer === "sammellinse" || userAnswer === "konvexlinse")) {
                 isCorrect = true;
            }
            else {
                 isCorrect = (userAnswer === correctAnswerText);
            }
        } else if (questionElement.type === 'radio') { 
            const radioGroup = document.getElementsByName(id); // Hier ist 'id' der Name der Gruppe
            for (const radio of radioGroup) {
                if (radio.checked) {
                    userAnswer = radio.value;
                    break;
                }
            }
            isCorrect = (userAnswer === correctAnswers[id]);
        }


        // Nur Feedback-Text und Klassen aktualisieren, wenn feedbackElement und parentQuestionDiv gültig sind
        if (feedbackElement && parentQuestionDiv) {
             if (isCorrect) {
                feedbackElement.textContent = 'Richtig!';
                feedbackElement.className = 'feedback correct';
                // parentQuestionDiv wird jetzt in checkAllAnswers für den Gesamtblock gefärbt
            } else {
                feedbackElement.textContent = 'Leider falsch. ';
                if (explanations[id]) {
                    feedbackElement.textContent += ' Tipp: ' + explanations[id];
                }
                feedbackElement.className = 'feedback incorrect';
            }
        } else if (feedbackElement && id.startsWith('label1_')) {
            // Spezialfall für individuelle Label-Feedbacks, die kein .question als direkten Parent haben
            if (isCorrect) {
                feedbackElement.textContent = 'Richtig!';
                feedbackElement.className = 'feedback correct';
            } else {
                feedbackElement.textContent = 'Falsch.';
                if (explanations[id]) {
                    feedbackElement.textContent += ` Tipp: ${explanations[id]}`;
                }
                feedbackElement.className = 'feedback incorrect';
            }
        }
        
        return isCorrect;
    }
    
    function checkAllAnswers() {
        let score = 0;
        let totalQuestions = 0;

        // Frage 1 (Lückentext)
        const q1_ids = ['q1_1', 'q1_2', 'q1_3', 'q1_4', 'q1_5'];
        let q1_all_correct = true;
        q1_ids.forEach(id => {
            totalQuestions++;
            if (!checkAnswer(id)) { // checkAnswer gibt jetzt nur true/false zurück
                q1_all_correct = false;
            } else {
                score++;
            }
        });
        const feedback_q1 = document.getElementById('feedback_q1');
        const q1_div = feedback_q1.closest('.question');
        if (q1_all_correct) {
            feedback_q1.textContent = 'Alle Lücken richtig ausgefüllt!';
            feedback_q1.className = 'feedback correct';
            q1_div.classList.add('correct'); q1_div.classList.remove('incorrect');
        } else {
            feedback_q1.textContent = 'Einige Lücken sind noch nicht korrekt. Die richtigen Antworten werden nicht einzeln angezeigt, versuche es erneut oder vergleiche mit deinen Notizen.';
            feedback_q1.className = 'feedback incorrect';
            q1_div.classList.add('incorrect'); q1_div.classList.remove('correct');
        }


        // Frage 2 (Labeling)
        // HTML wurde angepasst, um individuelle Feedback-Divs für label1_X und ein feedback_label1_overall zu haben.
        const label_ids = ['label1_1', 'label1_2', 'label1_3', 'label1_4', 'label1_5'];
        let label_all_correct = true;
        label_ids.forEach(id => {
            totalQuestions++;
            if (checkAnswer(id)) { // checkAnswer wird jetzt die individuellen feedback_labelX_Y aktualisieren
                score++;
            } else {
                label_all_correct = false;
            }
        });
        const feedback_label1_overall = document.getElementById('feedback_label1_overall');
        const label1_div = feedback_label1_overall.closest('.question');
        if (label_all_correct) {
            feedback_label1_overall.textContent = 'Alle Teile richtig benannt!';
            feedback_label1_overall.className = 'feedback correct';
            label1_div.classList.add('correct'); label1_div.classList.remove('incorrect');
        } else {
            feedback_label1_overall.textContent = 'Einige Teile sind noch nicht korrekt benannt. Überprüfe die einzelnen Hinweise.';
            feedback_label1_overall.className = 'feedback incorrect';
            label1_div.classList.add('incorrect'); label1_div.classList.remove('correct');
        }


        // Frage 3 (Radio)
        const q3_ids = ['q3_1', 'q3_2', 'q3_3'];
        q3_ids.forEach(groupName => { // groupName ist hier q3_1, q3_2, etc.
            totalQuestions++;
            // checkAnswer für Radio-Buttons braucht den Namen der Gruppe
            // und das Feedback-Element hat die ID 'feedback_' + groupName
            const feedbackElem = document.getElementById('feedback_' + groupName);
            const questionDiv = feedbackElem.closest('.question');
            let isRadioCorrect = false;
            const radios = document.getElementsByName(groupName);
            for (const radio of radios) {
                if (radio.checked) {
                    if (radio.value === correctAnswers[groupName]) {
                        isRadioCorrect = true;
                        score++;
                    }
                    break;
                }
            }

            if (isRadioCorrect) {
                feedbackElem.textContent = 'Richtig!';
                feedbackElem.className = 'feedback correct';
                questionDiv.classList.add('correct'); questionDiv.classList.remove('incorrect');
            } else {
                feedbackElem.textContent = 'Leider falsch. ';
                if (explanations[groupName]) {
                     feedbackElem.textContent += ' Tipp: ' + explanations[groupName];
                }
                feedbackElem.className = 'feedback incorrect';
                questionDiv.classList.add('incorrect'); questionDiv.classList.remove('correct');
            }
        });

        // Frage 5 (Radio und Text)
        ['q5_1', 'q5_2'].forEach(id_or_groupName => {
            totalQuestions++;
            const element = document.getElementById(id_or_groupName);
            const feedbackElem = document.getElementById('feedback_' + id_or_groupName);
            const questionDiv = feedbackElem.closest('.question');
            let isThisCorrect = false;

            if (element && element.type === 'text') { // Für q5_2
                 isThisCorrect = checkAnswer(id_or_groupName);
            } else { // Für q5_1 (Radio)
                const radios = document.getElementsByName(id_or_groupName);
                 for (const radio of radios) {
                    if (radio.checked) {
                        if (radio.value === correctAnswers[id_or_groupName]) {
                            isThisCorrect = true;
                        }
                        break;
                    }
                }
            }
            
            if(isThisCorrect) score++;

            // Feedback-Logik (ähnlich wie bei Frage 3)
            if (isThisCorrect) {
                feedbackElem.textContent = 'Richtig!';
                feedbackElem.className = 'feedback correct';
                questionDiv.classList.add('correct'); questionDiv.classList.remove('incorrect');
            } else {
                feedbackElem.textContent = 'Leider falsch. ';
                if (explanations[id_or_groupName]) {
                     feedbackElem.textContent += ' Tipp: ' + explanations[id_or_groupName];
                }
                feedbackElem.className = 'feedback incorrect';
                questionDiv.classList.add('incorrect'); questionDiv.classList.remove('correct');
            }
        });
        
        // Frage 6 (Radio und Text) - Ähnliche Logik wie Frage 5
        ['q6_1', 'q6_2', 'q6_3'].forEach(id_or_groupName => {
            totalQuestions++;
            const element = document.getElementById(id_or_groupName);
            const feedbackElem = document.getElementById('feedback_' + id_or_groupName);
            const questionDiv = feedbackElem.closest('.question');
            let isThisCorrect = false;

            if (element && element.type === 'text') {
                 isThisCorrect = checkAnswer(id_or_groupName);
            } else { 
                const radios = document.getElementsByName(id_or_groupName);
                 for (const radio of radios) {
                    if (radio.checked) {
                        if (radio.value === correctAnswers[id_or_groupName]) {
                            isThisCorrect = true;
                        }
                        break;
                    }
                }
            }
            if(isThisCorrect) score++;
            if (isThisCorrect) {
                feedbackElem.textContent = 'Richtig!';
                feedbackElem.className = 'feedback correct';
                questionDiv.classList.add('correct'); questionDiv.classList.remove('incorrect');
            } else {
                feedbackElem.textContent = 'Leider falsch. ';
                if (explanations[id_or_groupName]) {
                     feedbackElem.textContent += ' Tipp: ' + explanations[id_or_groupName];
                }
                feedbackElem.className = 'feedback incorrect';
                questionDiv.classList.add('incorrect'); questionDiv.classList.remove('correct');
            }
        });

        // Frage 7 (Radio und Text) - Ähnliche Logik wie Frage 5
        ['q7_1', 'q7_2', 'q7_3'].forEach(id_or_groupName => {
            totalQuestions++;
            const element = document.getElementById(id_or_groupName);
            const feedbackElem = document.getElementById('feedback_' + id_or_groupName);
            const questionDiv = feedbackElem.closest('.question');
            let isThisCorrect = false;

            if (element && element.type === 'text') {
                 isThisCorrect = checkAnswer(id_or_groupName);
            } else { 
                const radios = document.getElementsByName(id_or_groupName);
                 for (const radio of radios) {
                    if (radio.checked) {
                        if (radio.value === correctAnswers[id_or_groupName]) {
                            isThisCorrect = true;
                        }
                        break;
                    }
                }
            }
            if(isThisCorrect) score++;
            if (isThisCorrect) {
                feedbackElem.textContent = 'Richtig!';
                feedbackElem.className = 'feedback correct';
                questionDiv.classList.add('correct'); questionDiv.classList.remove('incorrect');
            } else {
                feedbackElem.textContent = 'Leider falsch. ';
                if (explanations[id_or_groupName]) {
                     feedbackElem.textContent += ' Tipp: ' + explanations[id_or_groupName];
                }
                feedbackElem.className = 'feedback incorrect';
                questionDiv.classList.add('incorrect'); questionDiv.classList.remove('correct');
            }
        });


        document.getElementById('score_display').textContent = `Du hast ${score} von ${totalQuestions} automatisch auswertbaren Aufgaben richtig gelöst.`;
        document.getElementById('overall_feedback').style.display = 'block';
        document.getElementById('overall_feedback').scrollIntoView({ behavior: 'smooth' });
    }

</script>

</body>
</html>
